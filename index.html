---
layout: default
title: Mortgage Calculator
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mortgage Calculator with Overpayment, Dates & Graph</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      max-width: 900px;
    }
    h1, h2 {
      color: #333;
    }
    form {
      background: #f9f9f9;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input {
      margin-top: 5px;
      padding: 5px;
      width: 100%;
      max-width: 300px;
    }
    button {
      margin-top: 15px;
      padding: 10px 15px;
    }
    .result {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ccc;
      background: #fafafa;
    }
    canvas {
      max-width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
  <h1>Mortgage Calculator with Overpayment, Dates & Graph</h1>
  <form id="mortgageForm">
    <label>
      Principal Amount (£):
      <input type="number" id="principal" step="0.01" required>
    </label>
    <label>
      Start Date:
      <input type="date" id="startDate" required>
    </label>
    <label>
      Remortgage Date:
      <input type="date" id="remortgageDate" required>
    </label>
    <label>
      End Date (Loan End Date):
      <input type="date" id="endDate" required>
    </label>
    <label>
      Initial Interest Rate (annual %):
      <input type="number" id="initialRate" step="0.01" required>
    </label>
    <label>
      Remortgage Interest Rate (annual %):
      <input type="number" id="remortgageRate" step="0.01" required>
    </label>
    <label>
      Regular Overpayment Amount per Month (£):
      <input type="number" id="overpayment" step="0.01">
    </label>
    <label>
      Lump Sum Overpayment (£):
      <input type="number" id="lumpSum" step="0.01">
    </label>
    <label>
      Lump Sum Overpayment Date:
      <input type="date" id="lumpSumDate">
    </label>
    <label>
      Expected Investment Return (annual %):
      <input type="number" id="investmentReturn" step="0.01">
    </label>
    <button type="button" onclick="calculateMortgage()">Calculate</button>
  </form>
  
  <div id="results" class="result"></div>
  
  <canvas id="myChart"></canvas>
  
  <!-- Include Chart.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <script>
    // Helper function to calculate the difference in whole months between two dates.
    function monthsBetween(date1, date2) {
      return (date2.getFullYear() - date1.getFullYear()) * 12 + (date2.getMonth() - date1.getMonth());
    }
    
    // Calculate the monthly payment using the standard amortization formula.
    function calculateMonthlyPayment(principal, annualRate, months) {
      let monthlyRate = annualRate / 100 / 12;
      return principal * monthlyRate / (1 - Math.pow(1 + monthlyRate, -months));
    }
    
    // Format a JavaScript Date as "MMM YYYY" (e.g., "Jan 2026")
    function formatDate(date) {
      const options = { year: 'numeric', month: 'short' };
      return date.toLocaleDateString(undefined, options);
    }
    
    // Simulate a monthly schedule for the mortgage and investment growth.
    // Returns arrays for date labels, mortgage balances (with and without overpayment),
    // and cumulative invested value (if the extra money were invested).
    function simulateSchedule(principal, startDate, remortgageDate, endDate, initialRate, remortgageRate, regularOverpayment, lumpSum, lumpSumDate, investmentReturn) {
      let totalMonths = monthsBetween(startDate, endDate);
      if(totalMonths < 1) totalMonths = 1;
      
      let fixedPeriodMonths = monthsBetween(startDate, remortgageDate);
      if(fixedPeriodMonths < 1) fixedPeriodMonths = 1;
      
      // Determine the lump sum month (if provided). We use a 0-index (month 0 = start month).
      let lumpSumMonth = lumpSumDate ? monthsBetween(startDate, new Date(lumpSumDate)) : -1;
      
      // Calculate initial monthly payment for the full term (no overpayments).
      let monthlyPaymentInitial = calculateMonthlyPayment(principal, initialRate, totalMonths);
      
      let dataLabels = [];
      let noOPBalances = [];
      let withOPBalances = [];
      let investedValues = [];
      
      let currentBalance_noOP = principal;
      let currentBalance_withOP = principal;
      let investedValue = 0;
      
      // For the initial phase, both scenarios use the same monthly payment.
      let monthlyPayment_noOP = monthlyPaymentInitial;
      let monthlyPayment_withOP = monthlyPaymentInitial;
      let currentRate = initialRate;
      
      // Determine monthly growth factor for the investment.
      let monthlyGrowth = investmentReturn ? (1 + investmentReturn/100/12) : 1;
      
      // Simulate each month.
      for (let i = 0; i <= totalMonths; i++) {
        // Compute the current date (advance i months from startDate).
        let currentDate = new Date(startDate);
        currentDate.setMonth(currentDate.getMonth() + i);
        dataLabels.push(formatDate(currentDate));
        
        // At the start of the remortgage period, recalculate monthly payments using the remortgage rate.
        if(i === fixedPeriodMonths) {
          let remainingMonths = totalMonths - i;
          monthlyPayment_noOP = calculateMonthlyPayment(currentBalance_noOP, remortgageRate, remainingMonths);
          monthlyPayment_withOP = calculateMonthlyPayment(currentBalance_withOP, remortgageRate, remainingMonths);
          currentRate = remortgageRate;
        }
        
        // For the "no overpayment" scenario, only update if there is an outstanding balance.
        if(currentBalance_noOP > 0) {
          let monthlyRate = currentRate / 100 / 12;
          let interest_noOP = currentBalance_noOP * monthlyRate;
          let principalComponent_noOP = monthlyPayment_noOP - interest_noOP;
          currentBalance_noOP -= principalComponent_noOP;
          if(currentBalance_noOP < 0) currentBalance_noOP = 0;
        }
        
        // For the "with overpayment" scenario:
        if(currentBalance_withOP > 0) {
          let monthlyRate = currentRate / 100 / 12;
          let interest_withOP = currentBalance_withOP * monthlyRate;
          let principalComponent_withOP = monthlyPayment_withOP - interest_withOP;
          // Apply the regular extra payment.
          let extra = regularOverpayment ? regularOverpayment : 0;
          // If this month matches the lump sum date, add the lump sum.
          if(lumpSumMonth >= 0 && i === lumpSumMonth) {
            extra += lumpSum;
          }
          currentBalance_withOP -= (principalComponent_withOP + extra);
          if(currentBalance_withOP < 0) currentBalance_withOP = 0;
        }
        
        // For the investment scenario: compound the invested money and add this month's contributions.
        let contribution = regularOverpayment ? regularOverpayment : 0;
        if(lumpSumMonth >= 0 && i === lumpSumMonth) {
          contribution += lumpSum;
        }
        investedValue = investedValue * monthlyGrowth + contribution;
        
        noOPBalances.push(currentBalance_noOP);
        withOPBalances.push(currentBalance_withOP);
        investedValues.push(investedValue);
      }
      
      return {
        labels: dataLabels,
        noOPBalances: noOPBalances,
        withOPBalances: withOPBalances,
        invested: investedValues
      };
    }
    
    // Main calculation function called when the "Calculate" button is pressed.
    function calculateMortgage() {
      // Retrieve and parse inputs.
      let principal = parseFloat(document.getElementById("principal").value);
      let startDate = new Date(document.getElementById("startDate").value);
      let remortgageDate = new Date(document.getElementById("remortgageDate").value);
      let endDate = new Date(document.getElementById("endDate").value);
      let initialRate = parseFloat(document.getElementById("initialRate").value);
      let remortgageRate = parseFloat(document.getElementById("remortgageRate").value);
      let regularOverpayment = parseFloat(document.getElementById("overpayment").value) || 0;
      let lumpSum = parseFloat(document.getElementById("lumpSum").value) || 0;
      let lumpSumDateInput = document.getElementById("lumpSumDate").value;
      let lumpSumDate = lumpSumDateInput ? new Date(lumpSumDateInput) : null;
      let investmentReturn = parseFloat(document.getElementById("investmentReturn").value) || 0;
      
      // Run the simulation.
      let simData = simulateSchedule(principal, startDate, remortgageDate, endDate, initialRate, remortgageRate, regularOverpayment, lumpSum, lumpSumDate, investmentReturn);
      
      // Calculate overall results based on the final month.
      let totalMonths = simData.labels.length - 1;
      let final_noOP = simData.noOPBalances[totalMonths];
      let final_withOP = simData.withOPBalances[totalMonths];
      let totalSavings = final_noOP - final_withOP;
      let finalInvested = simData.invested[totalMonths];
      
      let resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = `
        <h2>Results</h2>
        <p>Final Mortgage Balance without Overpayment: £${final_noOP.toFixed(2)}</p>
        <p>Final Mortgage Balance with Overpayment: £${final_withOP.toFixed(2)}</p>
        <p>Total Savings (Reduction in Mortgage Balance): £${totalSavings.toFixed(2)}</p>
        <p>Future Value if Overpayments Invested: £${finalInvested.toFixed(2)}</p>
        <p>Total Duration: ${totalMonths} months</p>
      `;
      
      // Create a graph comparing "Mortgage Savings" and "Invested Value".
      let ctx = document.getElementById('myChart').getContext('2d');
      if(window.myChart instanceof Chart) {
        window.myChart.destroy();
      }
      
      window.myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: simData.labels,
          datasets: [
            {
              label: 'Mortgage Savings (£)',
              // Savings is the difference between the no-overpayment and with-overpayment balances.
              data: simData.noOPBalances.map((balance, i) => balance - simData.withOPBalances[i]),
              borderColor: 'blue',
              fill: false
            },
            {
              label: 'Invested Value (£)',
              data: simData.invested,
              borderColor: 'green',
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          scales: {
            x: {
              title: {
                display: true,
                text: 'Date'
              }
            },
            y: {
              title: {
                display: true,
                text: 'Amount (£)'
              }
            }
          }
        }
      });
    }
  </script>
</body>
</html>
